# Строки в C#

В программировании скрытая магия встречается на каждом шагу. Например, даже простые типы значений вроде `int` или `double` 
на самом деле не так уж просты — это структуры, которые "маскируются" под нессылочные типы. 
Однако благодаря особенностям C# и .NET они всё равно ведут себя как полноценные объекты.

C# — это до мозга костей объектно-ориентированный язык. Это означает, что практически всё в нём является объектом, 
а каждый объект наследует свойства и методы базового класса `System.Object`. Представьте себе это как передачу 
генетического кода: как у всех людей есть общий набор базовых генов, так и у всех объектов есть общие свойства и методы. 
Например, все объекты умеют превращаться в строки благодаря методу `ToString()`.

[Строки](https://learn.microsoft.com/ru-ru/dotnet/csharp/language-reference/builtin-types/reference-types#the-string-type), 
представленные в C# типом `string`, тоже наследуют этот "геном" базового класса `System.Object`, но, как в природе, 
они дополнительно приобретают свои уникальные свойства и методы. Например:
- Свойство `Length` позволяет узнать длину строки.
- Метод `ToUpper()` превращает все буквы строки в заглавные.

Теперь давайте разберёмся, что такое строки в C#. Это **объекты**, которые представляют последовательности символов.
У строк есть методы и свойства для работы с текстом. Они помогают выполнять задачи вроде поиска, изменения текста или форматирования.

## Особенности строк в C#
1. **Строки — неизменяемые (immutable) объекты.**  
   Как только строка создаётся, её содержимое нельзя изменить. Любое изменение создаёт новую строку, а старая остаётся неизменной.

   ```c#
   string str = "Hello";
   str = str + " World"; // Создаётся новая строка, а старая "Hello" остаётся в памяти.
   ```

2. **У строк есть полезные свойства, например:**
    - `Length`: возвращает количество символов в строке.
      ```c#
      string text = "Example";
      Console.WriteLine(text.Length); // 7
      ```

3. **У строк есть полезные методы, например:**
    - `ToUpper()`: преобразует строку в верхний регистр.
      ```c#
      Console.WriteLine("hello".ToUpper()); // HELLO
      ```
    - `Replace()`: заменяет символы или подстроки.
      ```c#
      Console.WriteLine("cat".Replace("c", "b")); // bat
      ```

4. **Эффективность:**  
   Из-за неизменяемости строки подходят для большинства задач, но если нужно часто изменять текст (например, в цикле), лучше использовать `StringBuilder`. Этот класс позволяет эффективно создавать и изменять текст.
   ```c#
   using System.Text;

   StringBuilder sb = new StringBuilder("Hello");
   sb.Append(" World");
   Console.WriteLine(sb.ToString()); // Hello World
   ```

5. **Почему строки неизменяемы?**  
   Это сделано для безопасности и удобства:
    - Один объект строки можно безопасно использовать в разных потоках.
    - Неизменяемость упрощает интернирование строк — одинаковые строки хранятся в одном экземпляре, что экономит память.

Строки — это не просто текст. Это мощные и удобные объекты, которые дают нам множество инструментов для работы с 
текстовыми данными. Помните об их неизменяемости, и если потребуется часто модифицировать текст, выбирайте `StringBuilder`.

И со всем этим добром мы будем знакомиться в этом разделе, падаван.

## Конкатенация строк и подстановка значений в строки

В C# объединение строк и подстановка значений в строки можно выполнять разными способами: от базового использования 
оператора `+` до современных, более удобных механизмов, таких как интерполяция строк. Рассмотрим основные подходы.

### **1. Конкатенация строк**

#### **Использование оператора `+`**
Оператор `+` объединяет строки, добавляя их друг к другу. Это самый простой способ объединения строк.

Пример:
```C#
string firstName = "Иван";
string lastName = "Петров";

string fullName = firstName + " " + lastName;
Console.WriteLine(fullName); // Вывод: Иван Петров
```

#### **Проблемы с конкатенацией строк:**
1. **Читаемость:** Если строк много или они сложные, такой код становится трудно читаемым.
2. **Производительность:** При большом числе операций конкатенации создается много временных объектов, что может замедлить программу (особенно в циклах).

### **2. Подстановка значений в строки**

#### **Старый способ: Метод `string.Format`**
Метод `string.Format` позволяет подставлять значения в строку, используя плейсхолдеры `{0}`, `{1}` и т.д.

Пример:
```C#
string name = "Иван";
int age = 25;

string message = string.Format("Меня зовут {0}, мне {1} лет.", name, age);
Console.WriteLine(message); // Вывод: Меня зовут Иван, мне 25 лет.
```

- Плейсхолдеры заменяются значениями, переданными в `string.Format`.
- Это читабельнее, чем использование `+`, если строка большая.

#### **Старый способ с `Console.WriteLine`**
`Console.WriteLine` позволяет напрямую использовать плейсхолдеры без вызова `string.Format`.

Пример:
```C#
Console.WriteLine("Первое число {0}, второе число {1}", 1, 2);
// Вывод: Первое число 1, второе число 2
```

**Почему это работает?** Метод `Console.WriteLine` вызывает `string.Format` внутри себя.

### **3. Современный способ: Интерполяция строк**

Интерполяция строк (добавлена в C# 6.0) позволяет встроить значения переменных прямо в строку, используя `$"..."`.

Пример:
```C#
string name = "Иван";
int age = 25;

string message = $"Меня зовут {name}, мне {age} лет.";
Console.WriteLine(message); // Вывод: Меня зовут Иван, мне 25 лет.
```

**Преимущества:**
- Простой и читабельный синтаксис.
- Можно вставлять сложные выражения:
  ```C#
  Console.WriteLine($"7 + 4 = {7 + 4}"); // Вывод: 7 + 4 = 11
  ```

### **Ошибки при конкатенации строк и числовых значений**
>При объединении строки с числом, число автоматически преобразуется в строку!
> {style="warning"}

#### Пример ошибки:
```C#
Console.WriteLine("Сумма 7 + 4 = " + 7 + 4);
```

**Ожидаемый результат:**  
`Сумма 7 + 4 = 11`

**Фактический результат:**  
`Сумма 7 + 4 = 74`

**Почему так происходит?**
- Оператор `+` сначала объединяет строку `"Сумма 7 + 4 = "` с числом `7`, преобразуя число в строку. Затем объединяет эту строку с числом `4`, снова преобразуя число в строку.

#### **Как исправить:**
Используйте скобки для выполнения арифметического выражения перед конкатенацией:
```C#
Console.WriteLine("Сумма 7 + 4 = " + (7 + 4));
// Вывод: Сумма 7 + 4 = 11
```

Или используйте интерполяцию строк:
```C#
Console.WriteLine($"Сумма 7 + 4 = {7 + 4}");
// Вывод: Сумма 7 + 4 = 11
```

### **Какой способ выбрать?**

- **Конкатенация с `+`:** Используйте только для простых операций.
- **Метод `string.Format`:** Подходит для работы со строками в старом коде.
- **Интерполяция строк:** Рекомендуется в новых проектах, так как это самый читабельный и мощный способ работы со строками.

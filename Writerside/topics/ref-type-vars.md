# Переменные ссылочных типов

В языке программирования C# существуют два основных вида типов данных: **значимые типы** (value types) 
и **ссылочные типы** (reference types). Они различаются тем, как данные хранятся в памяти и как они передаются в методы.

Переменные типов значений вы уже должны были изучить. А вот ссылочные типы мы будем изучать гораздо дольше поскольку это
требует изучения ООП (объектно ориентированного программирования).

В этом разделе мы лишь слегка познакомимся с ними чтобы вы имели представление.

Для этого сперва надо понять разницу между типами значений и ссылочными типами.

## Разница между типами значений и ссылочными типами

### 1. **Типы значений**
Значимые типы хранят свои данные прямо в памяти переменной. Если переменная значимого типа копируется, создается новая 
независимая копия данных.

#### Хранение в памяти:
- Данные типа значения хранятся в **стеке** (stack).
- Каждый экземпляр типа значения имеет свою собственную копию данных.

#### Примеры:
- Примитивные типы: `int`, `float`, `double`, `bool`, `char`.
- Структуры (`struct`): Например, `DateTime`, `Point`.
- Перечисления (`enum`).

#### Пример кода:
```c#
int a = 10;
int b = a; // Копируется значение
b = 20;
Console.WriteLine(a); // 10, значение a не изменилось
```

#### Особенности:
- **Локальность:** Значимые типы часто используют стек, что делает операции с ними быстрыми.
- **Изолированность:** Копирование значимого типа создает независимый объект.

### 2. **Ссылочные типы**
Ссылочные типы хранят не сами данные, а **ссылку** (адрес) на область памяти в куче (heap), где данные находятся.

#### Хранение в памяти:
- Ссылка (указатель на объект) хранится в **стеке**.
- Сам объект размещается в **куче**, которая используется для долгосрочного хранения.

#### Примеры:
- Классы (`class`): Например, `string`, пользовательские классы.
- Интерфейсы (`interface`).
- Делегаты (`delegate`).
- Массива и строки (`string`).
- Встроенные типы: `object`.

#### Пример кода:
```c#
class Person { public string Name; }

Person p1 = new Person { Name = "Alice" };
Person p2 = p1; // Копируется ссылка
p2.Name = "Bob"; // Изменяется объект через ссылку
Console.WriteLine(p1.Name); // Bob, объект один и тот же
```

#### Особенности:
- **Общая ссылка:** При копировании ссылочного типа передается ссылка, а не сам объект. Поэтому изменения через одну переменную видны через другую.
- **Гибкость:** Ссылочные типы позволяют работать с большими и сложными структурами данных.

### 3. **Сравнение типов значений и ссылочных типов**

| **Характеристика**        | **Типы значений**                          | **Ссылочные типы**                    |
|---------------------------|--------------------------------------------|---------------------------------------|
| **Хранение данных**       | В памяти переменной (в стеке).             | В куче, ссылка в стеке.              |
| **Копирование**           | Создает копию данных.                     | Копирует ссылку на объект.           |
| **Передача в методы**     | Передается копия данных.                  | Передается копия ссылки.             |
| **Примеры**               | `int`, `double`, `bool`, `DateTime`.       | `string`, массивы, классы, делегаты. |
| **Изменение объекта**     | Не влияет на другие переменные.            | Видимо для всех ссылок на объект.    |

### 4. **Особенности переменных ссылочного типа**
Переменная ссылочного типа хранит **только ссылку** на область памяти в куче, где находится объект. Это приводит к тому, что:
- При присваивании другой переменной передается ссылка, а не сам объект.
- Если объект изменяется через одну ссылку, эти изменения видны через все другие ссылки на этот объект.

Время практики, падаван.

Создай консольное приложение `ex0041_ref_types` при помощи шаблона `tinyconsole` в папке
`episode02` и добавь его в файл решения `episode02.sln`. Это можно сделать как в командной строке, так и в любой IDE.

Приведите `Program.cs` к следующему виду:

```c#
class Program
{
    static void Main()
    {
        // Пример типа значения
        int value1 = 10;
        int value2 = value1;
        value2 += 5;
        WriteLine($"Тип значения: value1 = {value1}, value2 = {value2}"); // value1 = 10, value2 = 15

        // Пример ссылочного типа Class
        Person p1 = new Person { Name = "Alice" };
        Person p2 = p1; // Копируется ссылка на объект
        p2.Name = "Bob";
        WriteLine($"Ссылочный тип: p1.Name = {p1.Name}, p2.Name = {p2.Name}"); // p1.Name = Bob, p2.Name = Bob
    }
}

class Person
{
    public string Name;
}
```

Вывод программы:

```
Тип значения: value1 = 10, value2 = 15
Ссылочный тип: p1.Name = Bob, p2.Name = Bob
```

#### Объяснение:
1. **Тип значения (`int`):**
    - `value1` хранит значение `10`.
    - При присваивании `value2 = value1` копируется **само значение**, а не ссылка.
    - Изменение `value2` не затрагивает `value1`.

2. **Ссылочный тип (`Person`):**
    - `p1` хранит ссылку на объект `Person` в куче.
    - При присваивании `p2 = p1` копируется ссылка. Теперь обе переменные указывают на один и тот же объект.
    - Изменение объекта через `p2` влияет на `p1`.

### Вывод:
- **Типы значений** используются для простых данных, которые копируются без связи друг с другом.
- **Ссылочные типы** позволяют работать с объектами в куче, но требуют внимательности, так как изменения через одну ссылку видны через все остальные ссылки на этот объект.